UPDATE sec_ace SET conditionalScript='importClass(Packages.es.logongas.fpempresa.modelo.titulado.TipoFormacionAcademica);\r\nimportClass(Packages.es.logongas.fpempresa.modelo.comun.usuario.TipoUsuario);\r\nvar usuario=arguments.result;\r\nif (identity.idIdentity===usuario.idIdentity) {\r\nreturn false;\r\n}\r\nvar idCentro=identity.centro.idCentro;\r\n\r\nif (usuario.tipoUsuario===TipoUsuario.CENTRO) {\r\n\r\n    if (usuario.centro.idCentro===idCentro) {\r\n       return false;\r\n    } else {\r\n       return true;\r\n    }\r\n\r\n} else if (usuario.tipoUsuario===TipoUsuario.TITULADO) {\r\n\r\n    var formacionesAcademicas=usuario.titulado.formacionesAcademicas;\r\n\r\n    \r\n    function isRealizadoEnCentro(formacionesAcademicas,idCentro) {\r\n        for (var iterator = formacionesAcademicas.iterator(); iterator.hasNext();) {\r\n           var formacionAcademica=iterator.next();\r\n            if (formacionAcademica.tipoFormacionAcademica===TipoFormacionAcademica.CICLO_FORMATIVO) {\r\n                if (formacionAcademica.centro.idCentro===idCentro) {\r\n                    return true;\r\n                }\r\n            }\r\n       }\r\n       return false;\r\n    }\r\n    \r\n    if (isRealizadoEnCentro(formacionesAcademicas,idCentro)) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n\r\n} else {\r\n  return true;\r\n}\r\n\r\n' 
WHERE aceType='Deny' AND idPermission='23' AND idIdentity='33' AND secureResourceRegExp='.*BusinessProcess.Usuario.read';
